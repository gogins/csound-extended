<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 6.0.7.3 (Linux)"/>
	<meta name="created" content="2013-06-11T00:00:00.020113632"/>
	<meta name="changed" content="2019-08-18T20:24:22.692202629"/>
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<style type="text/css">
		@page { margin: 0.79in }
		p { margin-bottom: 0.08in }
		h1 { margin-bottom: 0.08in }
		h1.western { font-family: "Arial", sans-serif; font-size: 16pt }
		h1.cjk { font-family: "Microsoft YaHei"; font-size: 16pt }
		h1.ctl { font-family: "Mangal"; font-size: 16pt }
		pre.western { font-family: "Courier New", monospace }
		pre.cjk { font-family: "NSimSun", monospace }
		pre.ctl { font-family: "Courier New", monospace }
		h2 { margin-bottom: 0.08in }
		h2.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		h2.cjk { font-family: "Microsoft YaHei"; font-size: 14pt; font-style: italic }
		h2.ctl { font-family: "Mangal"; font-size: 14pt; font-style: italic }
		a:link { so-language: zxx }
	</style>
</head>
<body lang="en-US" dir="ltr">
<h1 class="western" align="center" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
User Guide<br/>
Csound for Android 
</h1>
<p align="center" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
<i><b>Michael Gogins</b></i></p>
<p align="center" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
<i><b>16 August 2019</b></i></p>
<p align="center" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
<br/>

</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">This
is an extremely basic guide to using the Csound for Android app. It
should be just enough to get you started if you already have some
experience with Csound or, at least, some other “Music N” type
software synthesizer.</p>
<h1 class="western" style="line-height: 115%">Changes in This Version</h1>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">This
version of Csound for Android features many changes and improvements:</p>
<ul>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The app is now built for 64 bit CPU architecture.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	Audio input and output now are implemented using Google’s Oboe
	library, which encapsulates differences between audio drivers on
	different Android platforms. Oboe is integrated with Csound in a new
	CsoundOboe C++ class.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The app now has a built-in text editor based on CodeMirror. The
	editor includes find and replace functions.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The user interface is tabbed for instantly switching between editing
	and performing.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The <i><b>Csound Reference Manual</b></i> appears in its own tab.<!-- <p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	Embeddable Common Lisp is available, as well as the nudruz and
	Common Music libraries, to support algorithmic composition in Common
	Lisp.</p> --><!-- <p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The software repository and build system have been simplified.
	Csound for Android and all native libraries and other dependencies
	are built directly from Android Studio.</p> --></p>
</ul>
<h1 class="western" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
Introduction</h1>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
Csound for Android app is an Android version of Csound, an audio and
music synthesis and processing language of great power, created by
Barry Vercoe in 1984, maintained with almost complete backward
compatibility since then, and widely used and taught for the creation
of electroacoustic and computer music. Desite its age, Csound
continues to be actively developed. It has many advanced features for
sound synthesis including user-designable instruments, an easy to
learn programming language with a type system, several phase
vocoders, several sample players, a plethora of digital oscillators,
filters, and envelope generators, and transparent multi-threading for
high performance on multi-core systems.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
Csound for Android app is by Victor Lazzarini, Steven Yi, Michael
Gogins, and others. The app contains virtually all of Csound,
including some of the more frequently used plugin opcodes:</p>
<ul>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The signal flow graph opcodes, for chaining instruments into effects
	chains and so on.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The Fluidsynth opcodes for playing SF2 samples.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The libstdutil library.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The scanned synthesis opcodes.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The Open Sound Control (OSC) opcodes which allow Csound to
	communicate over networks with other software in a low-latency and
	flexible manner.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	The Doppler opcode.</p>
</ul>
<h1 class="western" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
<!-- <p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">In
addition, Csound for Android now includes Embeddable Common Lisp
along with the nudruz and Common Music libraries to support
algorithmic composition in Lisp.</p> -->User
Interface</h1>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
Csound for Android user interface uses tabs for easy and swift
changes of context, for example between editing and performing. All
tabs share the app’s builtin instance of Csound. This enables, for
example, a piece to be written in HTML5 but utilize the builtin
widgets, and so forth. The tabs are:</p>
<ul>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Editor</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a built-in text editor based on CodeMirror, with find and replace
	functionality.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Messages</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Shows
	all diagnostic and informative messages printed by Csound.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>HTML</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a built-in HTML5-enabled Web browser for the display of custom user
	interfaces, computer graphics and animations, and so on.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Widgets</b></i><span style="font-variant: normal"> –
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a predefined set of 5 sliders, 5 buttons, and a trackpad that send
	updates to predefined Csound control channels. These widgets are
	backwards compatible with previous versions of the Csound for
	Android app.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Help</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	an embedded browser for the </span></span></span><i><b>Csound
	Reference Manual</b></i><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>About</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	an embedded browser for the Csound home page at <a href="http://csound.com/">http://csound.com</a>,
	enabling users to explore many uses and features of Csound.</span></span></span></p>
</ul>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
task menu of Csound for Android provides the following functions: 
</p>
<ul>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>New</b></i> – Creates a blank template Csound .csd file in
	the root directory of the user's storage for the user to edit. The
	.csd file will be remembered and performed by Csound.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Open</b></i> – Opens a file for editing. The file can be a
	Csound .csd file, or an HTML5 .html file. Each of these languages
	has access to the same instance of Csound that is exposed in the
	HTML tab or to the widgets in the Widgets tab.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Save as...</b></i> <span style="font-variant: normal">–
	Saves the current .csd or other file being edited under a new name.</span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Save</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Saves
	the current .csd</span></span></span><span style="font-variant: normal">
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">or
	other file being edited to the user’s storage.</span></span></span></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<i><b>Run/Stop</b></i> – If Csound is not running, starts a
	performance; if Csound is running, stops the performance. If the
	file is an .html file, it is reloaded in the HTML tab which has
	access to a Csound object encapsulating the app’s builtin instance
	of Csound. If the Csound options include <font face="Courier New, monospace">-odac</font><font face="Liberation Serif, serif">,
	Csound's audio output will go to the device audio output. If the
	element contains </font><font face="Courier New, monospace">-osoundfilename</font><font face="Liberation Serif, serif">,
	Csound's audio output will go to the file </font><font face="Courier New, monospace">soundfilename</font><font face="Liberation Serif, serif">,
	which should be a valid Linux pathname in the user's storage
	filesystem.</font> 
	</p>
	<li/>
<p><font face="Liberation Serif, serif"><i><b>Find... </b></i>–
	Search for a string of text in the editor.</font></p>
	<li/>
<p><font face="Liberation Serif, serif"><i><b>Replace…</b></i>
	– Replace a string of text in the editor.</font></p>
</ul>
<ul>
	<li/>
<p><i><b>Examples</b></i> – Opens a submenu with various
	built-in example pieces. These are saved in your device's external
	public storage Music directory, and then run.</p>
	<li/>
<p style="line-height: 115%"><i><b>User guide</b></i> –
	Opens this basic user guide.</p>
	<li/>
<p style="line-height: 115%"><i><b>Settings</b></i> –
	Includes the following choices. The values of the settings are saved
	on the device, and restored at the beginning of the next session.
	Please note, it may be necessary to provide the full path to the
	Csound app’s public data directory as the value of each directory,
	or as the first part of each directory. This information is printed
	by the Csound app in the Messages pane when it first starts.</p>
	<ul>
		<li/>
<p style="line-height: 115%"><i><b>Plugins directory</b></i>
		– Sets the value of the OPCODE6DIR64 environment variable.</p>
		<li/>
<p style="line-height: 115%"><i><b>Output directory</b></i> –
		Sets the value of the SFDIR environment variable. 
		</p>
		<li/>
<p style="line-height: 115%"><i><b>Samples directory</b></i>
		– Sets the value of the SSDIR environment variable.</p>
		<li/>
<p style="line-height: 115%"><i><b>Analysis directory</b></i>
		– Sets the value of the SADIR environment variable.</p>
		<li/>
<p style="line-height: 115%"><i><b>Include directory</b></i>
		– Sets the value of the INCDIR environment variable.</p>
	</ul>
</ul>
<h2 class="western" style="line-height: 115%">Predefined Widgets</h2>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
predefined widgets on the <i><b>Widgets </b></i>tab are assigned
control channel names <font face="Courier New, monospace">slider1</font>
through <font face="Courier New, monospace">slider9</font>, <font face="Courier New, monospace">butt1</font>
through <font face="Courier New, monospace">butt5</font>, <font face="Courier New, monospace">trackpad.x</font>,
and <font face="Courier New, monospace">trackpad.y</font>. In
addition, the accelerometer on the Android device is available as
<font face="Courier New, monospace">accelerometerX</font>,
<font face="Courier New, monospace">accelerometerY</font>, and
<font face="Courier New, monospace">accelerometerZ</font>. 
</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
values of these widgets are normalized between 0 and 1, and can be
read into Csound during performance using the <font face="Courier New, monospace">chnget</font>
opcode, like this: 
</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%"><font face="Courier New, monospace">kslider1_value
chnget “slider1”</font></p>
<p style="margin-top: 0.04in">The buttons send 1 when pressed, and 0
when released. The trackpad sends the x and y positions whenever the
user is moving his or her finger on the trackpad. The positions are
remembered when the the finger is removed.</p>
<h2 class="western" style="line-height: 115%">User-Defined Widgets</h2>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">User-defined
widgets are defined in an HTML file (Web page), or in a new <font face="Courier New, monospace">&lt;html&gt;</font>
element of the CSD file. This can in principle contain any valid
HTML5 code, including document elements, JavaScript, and styles.
JavaScript event handlers can be attached to any elements, including
range inputs (sliders). Such event handlers can call Java methods of
the <font face="Courier New, monospace">CsoundOboe</font> object
(<font face="Courier New, monospace">csound</font>), for example to
get or set control channel values, or to send new score events to
Csound.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
ability to send score events to Csound from JavaScript means that
JavaScript can be used as a high-level programming language in an
.html file for the purposes of algorithmic composition, even
interactive composition. All methods callable from <font face="Courier New, monospace">CsoundAppActivity</font>
and <font face="Courier New, monospace">CsoundOboe</font> are marked
with the <font face="Courier New, monospace">@JavascriptInterface</font>
attribute in the Csound for Android source code. For a basic example
of a user-defined widget setup, see the <font face="Courier New, monospace">Drone-HTML5.csd</font>
example file. Here is a snippet showing a slider's <font face="Courier New, monospace">onInput</font>
event handler setting a Csound control channel:</p>
<pre class="western" style="line-height: 115%; page-break-inside: avoid; page-break-before: auto; page-break-after: auto">&lt;script&gt;
function gk_Reverb_FeedbackUpdate(value) {
var numberValue = parseFloat(value)
csoundApp.setControlChannel('gk_Reverb_Feedback', numberValue);
}
&lt;/script&gt;</pre><h1 class="western" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
Examples</h1>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
menu of the Csound app features a number of built-in examples.
Selecting an example will cause its file or files to be copied to the
app's external public storage Music directory and loaded into the
app, ready to be performed or edited. Not all of the examples use the
widgets. The examples demonstrate not only some techniques for using
the Csound6 Android app, but also a few of the many different ways of
making music with Csound.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">When
I first encountered the Csound app, I was very impressed. Now that I
have been able to contribute to its development, I have come to
realize that a high end smartphone, not to mention a tablet, is in
every sense of the word a real computer. The limits to what can be
programmed on it are indefinable. On a high-end personal computer, it
is easier to type, and Csound runs quite a bit faster; but there is
no <i>essential</i> difference between running Csound on a computer
and running it on a smartphone.</p>
<h1 class="western" style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
A Tutorial Example</h1>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">This
example will take you through the process of creating a new Csound
piece, step by step. Obviously, this piece is not going to reveal
anything like the full power of Csound. It is only intended to get
you to the point of being able to create, edit, and run a Csound
piece that will actually make sound on your Android device – from
scratch.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Run
the Csound app...</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Press
the <b>New...</b> button. You should be presented with an input
dialog asking you for a filename for your piece. Type in <font face="Courier New, monospace">toot.csd</font>,
and press the <b>Ok</b> button. The file will be stored in the root
directory of your user storage on your device. You can save the file
to another place , if you like.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
text editor should now contain a “template” .csd file. Your job
is to fill out the minimum to hear something.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Create
a blank line between <font face="Courier New, monospace">&lt;CsOptions&gt;</font>
and <font face="Courier New, monospace">&lt;/CsOptions&gt;</font>,
and type <font face="Courier New, monospace">-odac -d -m3</font>.
This means send audio to the real-time output (<font face="Courier New, monospace">-odac</font>),
do not display any function tables (<font face="Courier New, monospace">-d</font>),
and log some informative messages during Csound's performance (<font face="Courier New, monospace">-m3</font>).</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Create
a blank line between <font face="Courier New, monospace">&lt;CsInstruments&gt;</font>
and <font face="Courier New, monospace">&lt;/CsInstruments&gt;</font>
and type the following text:</p>
<pre class="western" style="line-height: 115%">sr = 44100
ksmps = 10
nchnls = 1
<font color="#000000"><font face="Courier New, monospace"><font size="2" style="font-size: 9pt">instr 1</font></font></font>
asignal oscil 10000, 440
<font face="Courier New, monospace"><font size="2" style="font-size: 9pt">out asignal</font></font>
<font face="Courier New, monospace"><font size="2" style="font-size: 9pt">endin</font></font></pre><p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
This is just about the simplest possible Csound orchestra. The
orchestra header specifies an audio signal sampling rate of 44,100
frames per second, with 10 audio frames per control signal sample,
and one channel of audio output. The instrument is just a simple sine
oscillator. It plays a loud tone at concert A.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Create
a blank line between <font face="Courier New, monospace">&lt;CsScore&gt;</font>
and <font face="Courier New, monospace">&lt;/CsScore&gt;</font> and
type:</p>
<pre class="western" style="margin-top: 0.08in; margin-bottom: 0.08in; line-height: 115%">i1 0 5</pre><p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
This means play instrument 1 starting at time 0 for 5 seconds.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Invoke
the <b>Save</b> menu item.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">Press
the Csound app's <b>Start</b> button. You should hear a loud sine
tone for 5 seconds.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">If
you want to save your audio output to a soundfile named <font face="Courier New, monospace">test.wav</font>,
change <font face="Courier New, monospace">-odac</font> above to
<font face="Courier New, monospace">-o/sdcard/test.wav</font>.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">That's
it!</p>
<h1 class="western">Issues and Workarounds</h1>
<h2 class="western">Audio Performance</h2>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">The
Android operating system has only recently been given an audio driver
layer, AAudio, that is even marginally adequate for musical use. Only
recent devices support this, and even some of them have issues. The
Oboe driver used by this app can be configured by the user for either
AAudio or the older OpenSL ES audio driver to suit your device.</p>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">If
you experiences glitches or low latency, try the following:</p>
<ul>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	Look at the Csound messages to see which driver Oboe is using, and
	use the <i><b>Settings</b></i>, <i><b>Audio drive</b></i>r choice to
	set the other one.</p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	Experiment with Csound’s <font face="Courier New, monospace">ksmps
	</font><font face="Liberation Serif, serif">option in the orchestra
	header.</font></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<font face="Liberation Serif, serif">Close all other apps on your
	device, and clear all caches.</font></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<font face="Liberation Serif, serif">Turn on Airplane Mode.</font></p>
	<li/>
<p style="margin-top: 0.08in; margin-bottom: 0in; line-height: 115%">
	<font face="Liberation Serif, serif">Experiment with your device’s
	Power Saving or Performance mode.</font></p>
</ul>
<h2 class="western">File System</h2>
<p>The Android operating system has new and sometimes awkward
security restrictions on how applications can read and write files on
your device. Applications are required to specify any storage
directories on which the user might write files. 
</p>
<p>For the Csound for Android app, the default public storage
directory is <font face="Courier New, monospace">Music</font>, which
on many devices is <span style="font-variant: normal"><font face="Courier New, monospace"><span style="font-style: normal">/storage/emulated/0/Music</span></font></span><span style="font-variant: normal"><span style="font-style: normal">.
If your pieces cannot read or write some file, such as a SoundFont,
sample soundfile, include file, or anything else, try putting
everything in this directory. Subdirectories of this should also
work. On startup, you can look at the </span></span><i><b>Messages</b></i><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">pane
to see what Csound is actually using for the public data directory.</span></span></p>
<h2 class="western">Screen Sizes</h2>
<p>The sizes of fonts and widgets in the Csound for Android app can
be configured to some extent in the device’s Android settings,
namely in the <i><b>Settings</b></i>, <i><b>Display</b></i>, <i><b>Font
size and style</b></i> section and <i><b>Screen zoom</b></i> section.</p>
</body>
</html>